<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฏุงุดุจูุฑุฏ ูุฏุฑุช ุงูููุชโุจูุฏ ูพุฑูฺูโูุง ููฺฉโุขุจุฑูุฏ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            direction: rtl;
            background-color: #f1f5f9;
        }
        .logo-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 1rem 0;
        }
        .logo { height: 90px; width: auto; object-fit: contain; }
        .logo.center { height: 180px; }
        .logo.right { height: 100px; }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 340px;
            background-color: #f8fafc;
            color: #334155;
            text-align: right;
            border-radius: 8px;
            padding: 1rem;
            position: absolute;
            z-index: 10;
            bottom: 115%;
            left: 50%;
            margin-left: -170px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            line-height: 1.7;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
        .slider { -webkit-appearance: none; appearance: none; width: 100%; height: 8px; border-radius: 4px; background-color: #e2e8f0; outline: none; }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 24px; height: 24px; border-radius: 50%;
            cursor: pointer; background-color: var(--thumb-color); border: 4px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider::-moz-range-thumb {
            width: 24px; height: 24px; border-radius: 50%; cursor: pointer;
            background-color: var(--thumb-color); border: 4px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .reset-btn {
            background-color: #475569; color: white; font-weight: bold; padding: 0.5rem 1rem;
            border-radius: 0.5rem; transition: background-color 0.2s;
        }
        .reset-btn:hover { background-color: #334155; }
        .priority-matrix-cell {
            display: flex; justify-content: center; align-items: center; width: 100%; height: 60px;
            color: white; font-weight: 800; font-size: 1.25rem; border-radius: 0.5rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4); transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .priority-matrix-cell:hover { transform: scale(1.1); box-shadow: 0 8px 20px rgba(0,0,0,0.2); z-index: 5; }
        .matrix-tooltip .tooltiptext { width: 300px; margin-left: -150px; background-color: #1e2b3b; color: #fff; text-align: center; }
        .timeline-item { position: relative; padding-bottom: 2rem; padding-right: 2.5rem; border-right: 2px solid #cbd5e1; }
        .timeline-item:last-child { border-right: 2px solid transparent; }
        .timeline-icon {
            position: absolute; right: -21px; top: 0; display: flex; align-items: center; justify-content: center;
            width: 40px; height: 40px; border-radius: 50%; background-color: white; border: 2px solid #cbd5e1;
        }
        #scenario-card {
            border-right: 5px solid;
            transition: border-color 0.5s ease;
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-white shadow-sm">
        <div class="logo-container">
            <img src="https://uploadkon.ir/uploads/c1c428_25logo-IMPcoPNG.png" alt="ููฺฏู ุงุฏู ูพุฑุฏุงุฒ ูุญุท" class="logo">
            <img src="https://uploadkon.ir/uploads/df5427_25NA-LOGO-copy.png" alt="ููฺฏู ููฺฉ ุขุจุฑูุฏ" class="logo center">
            <img src="https://uploadkon.ir/uploads/611127_25OMS-LOGO-copy.png" alt="ููฺฏู ุนูุฑุงู ูุณฺฉู ุดูุงู" class="logo right">
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-6">
        <div class="card mb-6">
            <h1 class="text-2xl font-bold text-center text-slate-700 mb-2">ุฏุงุดุจูุฑุฏ ุฑุงูุจุฑุฏ ุงูููุชโุจูุฏ ูพุฑูฺูโูุง ุฒุฑุณุงุฎุช</h1>
            <p class="text-center text-slate-600 max-w-4xl mx-auto">ุงู ุฏุงุดุจูุฑุฏ ฺฉ ุงุจุฒุงุฑ ุชุตููโฺฏุฑ ุชุนุงูู ุงุณุช ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑูุดโุดูุงุณ ุนูู <strong>ุชุญูู ุชุตููโฺฏุฑ ฺูุฏูุนุงุฑู (AHP-TOPSIS)</strong>ุ ูพุฑูฺูโูุง ุฒุฑุณุงุฎุช ุดูุฑฺฉ ููฺฉโุขุจุฑูุฏ ุฑุง ุงูููุชโุจูุฏ ูโฺฉูุฏ. ุจุง ุชุฑฺฉุจ <strong>ูุฑุขูุฏ ุชุญูู ุณูุณููโูุฑุงุชุจ (AHP)</strong> ุจุฑุง ูุฒูโุฏู ุจู ูุนุงุฑูุง ู <strong>ุฑูุด TOPSIS</strong> ุจุฑุง ุฑุชุจูโุจูุฏ ููุงุ ฺฉ ููุดู ุฑุงู ุฏุงุฏูโูุญูุฑ ุจุฑุง ุณุฑูุงูโฺฏุฐุงุฑโูุง ุขุช ุงุฑุงุฆู ูโุดูุฏ. ุดูุง ูโุชูุงูุฏ ุจุง ุชุบุฑ ูุฒู ุงุจุนุงุฏ ุงุตูุ ุชุฃุซุฑ ุณูุงุฑููุง ูุฎุชูู ุฑุงูุจุฑุฏ ุฑุง ุจุฑ ุฑุชุจูโุจูุฏ ูพุฑูฺูโูุง ูุดุงูุฏู ููุงุฏ.</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
             <div class="card text-center tooltip">
                <h3 class="text-lg font-bold" style="color:#7a5195;">ุถุฑูุฑุช ู ุชุฃุซุฑ ุงุฌุชูุงุน</h3>
                <p id="social-card-value" class="text-4xl font-extrabold my-2" style="color:#7a5195;"></p>
                <p class="text-xs text-slate-500">ูพุงุณุฎฺฏู ุจู ูุงุฒูุง ุงุณุงุณ</p>
                <div class="tooltiptext">
                    <p class="mb-3">ุงู ุจูุนุฏุ ูพุฑูฺูโูุง ุฑุง ุฏุฑ ุงูููุช ูุฑุงุฑ ูโุฏูุฏ ฺฉู <strong style="color:#7a5195;">ูุงุฒูุง ุญุงุช</strong> ุณุงฺฉูุงู ุฑุง ุจุฑุทุฑู ฺฉุฑุฏูุ <strong style="color:#7a5195;">ฺฉูุจูุฏูุง ุฒุฑุณุงุฎุช</strong> ุฑุง ุฌุจุฑุงู ูโฺฉููุฏ ู ุจู ุจุดุชุฑู ุฌูุนุช ููฺฉู ุฎุฏูุชโุฑุณุงู ูโููุงูุฏ. ุงู ุงุตู ูุณุชููุงู ุจู <strong style="color:#7a5195;">ุฑูุน ูุงุจุฑุงุจุฑ</strong> ู ุงุฑุชูุง <strong style="color:#7a5195;">ุจูุฏุงุดุช ู ุงูู ุนููู</strong> ูโูพุฑุฏุงุฒุฏ.</p>
                    <h4 class="font-bold text-sm mb-2 border-t border-slate-300 pt-2">ุฒุฑุดุงุฎุตโูุง ฺฉูุฏ:</h4>
                    <ul class="text-sm list-none p-0">
                        <li class="flex items-center mb-1"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #7a5195;"></span>ุฑูุน ฺฉูุจูุฏูุง ุญุงุช</li>
                        <li class="flex items-center mb-1"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #7a5195;"></span>ุฌูุนุช ุชุญุช ูพูุดุด</li>
                        <li class="flex items-center"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #7a5195;"></span>ุงุฑุชูุง ุจูุฏุงุดุช ู ุงูู</li>
                    </ul>
                </div>
            </div>
             <div class="card text-center tooltip">
                <h3 class="text-lg font-bold" style="color:#ef5675;">ุชูุฌู ุงูุชุตุงุฏ ู ูุงู</h3>
                <p id="economic-card-value" class="text-4xl font-extrabold my-2" style="color:#ef5675;"></p>
                <p class="text-xs text-slate-500">ฺฉุงุฑุง ูุฒูู ู ุจูููโุณุงุฒ ููุงุจุน</p>
                <div class="tooltiptext">
                    <p class="mb-3">ุงู ุจูุนุฏุ ฺฉุงุฑุง ุชุฎุตุต ููุงุจุน ูุญุฏูุฏ ูุงู ุฑุง ูโุณูุฌุฏ. ูพุฑูฺูโูุง ฺฉู <strong style="color:#ef5675;">ูุฒูู ฺฉูุชุฑ ุจู ุงุฒุง ูุฑ ุฎุงููุงุฑ</strong> ุจูุฑูโููุฏ ุฏุงุฑูุฏ (ฺฉุงุฑุง ุจุงูุงุชุฑ) ู <strong style="color:#ef5675;">ูุฒูู ฺฉู ฺฉูุชุฑ</strong> ุฏุงุฑูุฏุ ุฏุฑ ุงูููุช ูุฑุงุฑ ูโฺฏุฑูุฏ ุชุง ุจุงุฒุฏู ุณุฑูุงูโฺฏุฐุงุฑ ุญุฏุงฺฉุซุฑ ุดูุฏ.</p>
                     <h4 class="font-bold text-sm mb-2 border-t border-slate-300 pt-2">ุฒุฑุดุงุฎุตโูุง ฺฉูุฏ:</h4>
                    <ul class="text-sm list-none p-0">
                        <li class="flex items-center mb-1"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #ef5675;"></span>ูุฒูู ุจู ุงุฒุง ูุฑ ุฎุงููุงุฑ</li>
                        <li class="flex items-center"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #ef5675;"></span>ูุฒูู ฺฉู ูพุฑูฺู</li>
                    </ul>
                </div>
            </div>
             <div class="card text-center tooltip">
                <h3 class="text-lg font-bold" style="color:#bc5090;">ุงูฺฉุงูโุณูุฌ ูู ู ุชูุงู ุงุฌุฑุง</h3>
                <p id="technical-card-value" class="text-4xl font-extrabold my-2" style="color:#bc5090;"></p>
                <p class="text-xs text-slate-500">ุฑุนุงุช ุงุตูู ูููุฏุณ ู ูพุดโูุงุฒ</p>
                <div class="tooltiptext">
                     <p class="mb-3">ุญุงุชโุชุฑู ุจูุนุฏ ูู ฺฉู ูพุฑูฺูโูุง ุฑุง ุจุฑ ุงุณุงุณ <strong style="color:#bc5090;">ุชุฑุชุจ ุตุญุญ ูููุฏุณ (ูพุดโูุงุฒ)</strong> ุงูููุชโุจูุฏ ูโฺฉูุฏ. ุงุฌุฑุง ุชุฃุณุณุงุช ุฒุฑุฒูู (ุขุจุ ุจุฑู) ุจุงุฏ ูพุด ุงุฒ ุนููุงุช ุฑูุณุงุฒ (ุฑุงูโุณุงุฒ) ุงูุฌุงู ุดูุฏ ุชุง ุงุฒ <strong style="color:#bc5090;">ุชุฎุฑุจุ ุฏูุจุงุฑูโฺฉุงุฑ ู ุงุชูุงู ูุฒูู</strong> ุฌููฺฏุฑ ุดูุฏ.</p>
                      <h4 class="font-bold text-sm mb-2 border-t border-slate-300 pt-2">ุฒุฑุดุงุฎุต ฺฉูุฏ:</h4>
                    <ul class="text-sm list-none p-0">
                        <li class="flex items-center"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #bc5090;"></span>ุชูุงู ููุทู ู ูพุดโูุงุฒ</li>
                    </ul>
                </div>
            </div>
             <div class="card text-center tooltip">
                <h3 class="text-lg font-bold" style="color:#ffa600;">ูพุงุฏุงุฑ ู ููุงุญุธุงุช ูุญุท</h3>
                <p id="environmental-card-value" class="text-4xl font-extrabold my-2" style="color:#ffa600;"></p>
                <p class="text-xs text-slate-500">ุญูุงุธุช ุงุฒ ููุงุจุน ู ฺฉุงูุด ุขููุฏฺฏ</p>
                 <div class="tooltiptext">
                    <p class="mb-3">ุงู ุจูุนุฏุ ููุณู ูพุฑูฺู ุจุง <strong style="color:#ffa600;">ุงุตูู ุชูุณุนู ูพุงุฏุงุฑ</strong> ุฑุง ุงุฑุฒุงุจ ูโฺฉูุฏ. ูพุฑูฺูโูุง ูุงููุฏ ุดุจฺฉู ูุงุถูุงุจ ฺฉู ุจู <strong style="color:#ffa600;">ุญูุงุธุช ุงุฒ ููุงุจุน ุขุจ ู ุฎุงฺฉ</strong> ููุทูู ฺฉูฺฉ ฺฉุฑุฏู ู ุงุฒ <strong style="color:#ffa600;">ุขููุฏฺฏโูุง ุฒุณุชโูุญุท</strong> ุฌููฺฏุฑ ูโฺฉููุฏุ ุงูุชุงุฒ ูฺูโุง ฺฉุณุจ ูโฺฉููุฏ.</p>
                    <h4 class="font-bold text-sm mb-2 border-t border-slate-300 pt-2">ุฒุฑุดุงุฎุต ฺฉูุฏ:</h4>
                    <ul class="text-sm list-none p-0">
                        <li class="flex items-center"><span class="w-3 h-3 rounded-full ml-2" style="background-color: #ffa600;"></span>ฺฉุงูุด ุงุซุฑุงุช ููู ุฒุณุชโูุญุท</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card mb-6">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-xl font-bold text-slate-800">ฺฉูุชุฑู ูพูู ูุฒูโุฏู ุงุจุนุงุฏ ุงุตู</h2>
                <button id="reset-weights" class="reset-btn">ุจุงุฒฺฏุดุช ุจู ูุฒูโูุง ุงููู</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 pt-2">
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <label for="social-weight" class="font-bold text-slate-700">ุถุฑูุฑุช ู ุชุฃุซุฑ ุงุฌุชูุงุน</label>
                        <span id="social-weight-value" class="font-bold text-lg" style="color:#7a5195;"></span>
                    </div>
                    <input type="range" id="social-weight" min="0" max="100" class="slider" style="--thumb-color:#7a5195;">
                </div>
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <label for="economic-weight" class="font-bold text-slate-700">ุชูุฌู ุงูุชุตุงุฏ ู ูุงู</label>
                        <span id="economic-weight-value" class="font-bold text-lg" style="color:#ef5675;"></span>
                    </div>
                    <input type="range" id="economic-weight" min="0" max="100" class="slider" style="--thumb-color:#ef5675;">
                </div>
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <label for="technical-weight" class="font-bold text-slate-700">ุงูฺฉุงูโุณูุฌ ูู ู ุชูุงู ุงุฌุฑุง</label>
                        <span id="technical-weight-value" class="font-bold text-lg" style="color:#bc5090;"></span>
                    </div>
                    <input type="range" id="technical-weight" min="0" max="100" class="slider" style="--thumb-color:#bc5090;">
                </div>
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <label for="environmental-weight" class="font-bold text-slate-700">ูพุงุฏุงุฑ ู ููุงุญุธุงุช ูุญุท</label>
                        <span id="environmental-weight-value" class="font-bold text-lg" style="color:#ffa600;"></span>
                    </div>
                    <input type="range" id="environmental-weight" min="0" max="100" class="slider" style="--thumb-color:#ffa600;">
                </div>
            </div>
        </div>

        <div id="scenario-card" class="card mb-6">
            <div class="flex items-center mb-3">
                <span id="scenario-icon" class="text-3xl ml-3"></span>
                <h2 id="scenario-title" class="text-xl font-bold"></h2>
            </div>
            <div id="scenario-content">
                <!-- Dynamic content will go here -->
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <div class="lg:col-span-5 card">
                <h3 class="text-xl font-bold text-center mb-4 text-slate-700">ุฑุชุจูโุจูุฏ ุชุฌูุน ุจุฑ ุงุณุงุณ ููุน ุฒุฑุณุงุฎุช</h3>
                <div class="relative h-[300px]">
                     <canvas id="projectTypeChart"></canvas>
                 </div>
            </div>
            <div class="lg:col-span-2 card">
                 <h3 class="text-xl font-bold text-center mb-4 text-slate-700">ฑฐ ูพุฑูฺู ุจุง ุจุงูุงุชุฑู ุงูููุช</h3>
                 <div class="relative h-[450px]">
                     <canvas id="topProjectsChart"></canvas>
                 </div>
            </div>
            <div class="lg:col-span-3 card">
                <h3 class="text-xl font-bold text-center mb-2 text-slate-700">ูุงุชุฑุณ ุงูููุช ูพุฑูฺูโูุง</h3>
                <p class="text-center text-slate-500 text-sm mb-4">ุงู ูุงุชุฑุณ ุฑุชุจู ูุฑ ูพุฑูฺู ุฑุง ุฏุฑ ุชูุงุทุน ููุน ุฒุฑุณุงุฎุช ู ูุญูู ููุงุด ูโุฏูุฏ. ุฑูฺฏ ุขุจ ููุงุงูฺฏุฑ ุจุงูุงุชุฑู ุงูููุช (ุฑุชุจู ฑ) ู ุฑูฺฏ ูุฑูุฒ ููุงุงูฺฏุฑ ูพุงูโุชุฑู ุงูููุช (ุฑุชุจู ดฐ) ุงุณุช. ุจุฑุง ูุดุงูุฏู ุฌุฒุฆุงุช ู ุชูุฌู ุฑุชุจูุ ูุงูุณ ุฑุง ุฑู ูุฑ ุณููู ูฺฏู ุฏุงุฑุฏ.</p>
                <div id="priority-matrix" class="grid grid-cols-6 gap-2 text-xs text-center p-2 bg-slate-50 rounded-lg">
                </div>
            </div>
        </div>
        
        <div class="card mt-6">
            <h2 class="text-2xl font-bold text-center text-slate-700 mb-6">ุชุญููุ ูพุงูุฏูุง ุฑุงูุจุฑุฏ ู ููุดู ุฑุงู ุงุฌุฑุง ูุงุฒ</h2>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-slate-50 p-4 rounded-lg border-r-4 border-blue-500">
                    <h3 class="font-bold text-lg text-blue-800">ุงูููุช ูุทูู ูพุฑูฺูโูุง ุขุจุฑุณุงู ู ุจุฑูโุฑุณุงู</h3>
                    <p class="text-slate-600 mt-2">ูุชุงุฌ ุจู ูุถูุญ ูุดุงู ูโุฏูุฏ ฺฉู ูพุฑูฺูโูุง <strong>ุขุจุฑุณุงู ู ุจุฑูโุฑุณุงู</strong> ุจู ุฏูู ูุฒู ุจุงูุง ุดุงุฎุต "ุชูุงู ูู"ุ ุฏุฑ ุตุฏุฑ ูุณุช ุงูููุชโูุง ูุฑุงุฑ ุฏุงุฑูุฏ. ุงู ุงูุฑ ุงุฒ ุฏูุจุงุฑูโฺฉุงุฑโูุง ูพุฑูุฒูู ุฌููฺฏุฑ ฺฉุฑุฏู ู ุจุณุชุฑ ูุงุฒู ุจุฑุง ุชูุณุนูโูุง ุขุช ุฑุง ูุฑุงูู ูโฺฉูุฏ.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg border-r-4 border-green-500">
                    <h3 class="font-bold text-lg text-green-800">ูุญูุงุช ฺฉุงุฑุขูุฏ: ฺฉุงููู ุฏุณุชุงูุฑุฏูุง ุณุฑุน</h3>
                    <p class="text-slate-600 mt-2">ูุญูุงุช <strong>ตุ ณ ู ฒ</strong> ุจู ุฏูู ุฌูุนุช ุจุงูุง ู ูุฒูู ูพุงูโุชุฑ ุจู ุงุฒุง ูุฑ ุฎุงููุงุฑุ ุจุงูุงุชุฑู ุงูููุช ุฑุง ุจุฑุง ุณุฑูุงูโฺฏุฐุงุฑ ุฏุงุฑูุฏ. ุชฺฉูู ูพุฑูฺูโูุง ุฏุฑ ุงู ูุญูุงุช ุจุง ูุฒูู ฺฉูุชุฑุ ุจุดุชุฑู ุชุนุฏุงุฏ ุฎุงููุงุฑ ุฑุง ุจูุฑูโููุฏ ูโุณุงุฒุฏ.</p>
                </div>
            </div>

            <div>
                <div class="timeline-item">
                     <div class="timeline-icon bg-red-100 border-red-500">
                        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h3 class="font-bold text-xl text-red-700 mb-1">ูุงุฒ ฑ (ุณุงู ฑ-ฒ): ุชุฃูู ุขุจ ู ุจุฑู ุจุง ุจุงุฒุฏู ุจุงูุง</h3>
                    <p class="text-slate-600"><strong>ุชูุฑฺฉุฒ:</strong> ุงุฌุฑุง ูพุฑูฺูโูุง ุขุจุฑุณุงู ู ุจุฑูโุฑุณุงู ุจุง ุจุงูุงุชุฑู ุฑุชุจู ุฏุฑ ูุญูุงุช ฺฉุงุฑุขูุฏ ฒุ ณุ ต ู ถ (ูพุฑูฺูโูุง P51, P31, P21, P22, P52, P32). ุงู ูพุฑูฺูโูุง ุฏุณุชุงูุฑุฏูุง ุณุฑุน ูุณุชูุฏ.</p>
                    <p class="text-slate-600 mt-1"><strong>ูพุฑูฺู ุณุณุชู:</strong> ุขุบุงุฒ ูพุฑูฺู ุงุฑุชูุง ุดุจฺฉู ุจุฑู ู ูุฑูฺฏุงู ุจู ุนููุงู ูพุดโูุงุฒ.</p>
                    <p class="text-slate-600 mt-1"><strong>ูุฏู:</strong> ุชฺฉูู ุดุจฺฉูโูุง ุญุงุช ุฏุฑ ููุงุทู ูพุฑุฌูุนุช ู ุชุซุจุช ุฎุฏูุงุช ุจุฑุง ุจุฎุด ุจุฒุฑฺฏ ุงุฒ ุณุงฺฉูุงู ูุนู.</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-icon bg-orange-100 border-orange-500">
                       <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.657 7.343A8 8 0 0117.657 18.657z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1014.12 11.88"></path></svg>
                    </div>
                    <h3 class="font-bold text-xl text-orange-700 mb-1">ูุงุฒ ฒ (ุณุงู ณ-ด): ุฑูุน ูุญุฑููุช ู ฺฏุณุชุฑุด ุดุจฺฉู ฺฏุงุฒ</h3>
                    <p class="text-slate-600"><strong>ุชูุฑฺฉุฒ:</strong> ุงุฌุฑุง ูพุฑูฺูโูุง ุขุจ ู ุจุฑู ุฏุฑ ูุญูุงุช ฺฉูุชุฑ ุชูุณุนูโุงูุชู ท ู ธ. ููุฒูุงูุ ุขุบุงุฒ ูพุฑูฺูโูุง ฺฏุงุฒุฑุณุงู ุจุง ุงูููุช ุจุงูุง ุฏุฑ ูุญูุงุช ุชูุณุนูโุงูุชู (P53, P33, P23).</p>
                    <p class="text-slate-600 mt-1"><strong>ูพุฑูฺู ุณุณุชู:</strong> ุงุฌุฑุง ุจุฎุดโูุง ุงุตู ุณุณุชู ุฒูฺฉุด ู ูุฏุฑุช ุขุจโูุง ุณุทุญ.</p>
                    <p class="text-slate-600 mt-1"><strong>ูุฏู:</strong> ุฑุณุงูุฏู ุฎุฏูุงุช ุงููู ุจู ููุงุทู ูุญุฑูู ู ุดุฑูุน ูุงู ุฏูู ุฒุฑุณุงุฎุชโูุง.</p>
                </div>
                 <div class="timeline-item">
                    <div class="timeline-icon bg-sky-100 border-sky-500">
                        <svg class="w-6 h-6 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14l9-5-9-5-9 5 9 5z"></path><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-9.998 12.078 12.078 0 01.665-6.479L12 14z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-9.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"></path></svg>
                    </div>
                    <h3 class="font-bold text-xl text-sky-700 mb-1">ูุงุฒ ณ (ุณุงู ต ุจู ุจุนุฏ): ุชฺฉูู ุดุจฺฉูโูุง ูุงุถูุงุจ ู ุฑุงูโุณุงุฒ ููุง</h3>
                    <p class="text-slate-600"><strong>ุชูุฑฺฉุฒ:</strong> ุงุฌุฑุง ูพุฑูฺูโูุง ูุงุถูุงุจ ุจุฑ ุงุณุงุณ ุฑุชุจูโุจูุฏ (ุจุง ุงูููุช ูุญูุงุช ตุ ณ ู ฒ) ู ุณูพุณ ุขุบุงุฒ ูพุฑูฺูโูุง ุฑุงูโุณุงุฒ.</p>
                    <p class="text-slate-600 mt-1"><strong>ูพุฑูฺู ุณุณุชู:</strong> ุชฺฉูู ูพุฑูฺูโูุง ุจูุจูุฏ ุฏุณุชุฑุณ ูุงููุฏ ุฑุงู ุฏุณุชุฑุณ ุบุฑุจ.</p>
                    <p class="text-slate-600 mt-1"><strong>ูุฏู:</strong> ููุงโุณุงุฒ ุดุจฺฉู ุฒุฑุณุงุฎุชุ ุจูุจูุฏ ฺฉูุช ุจูุฏุงุดุช ู ูุญุท ุฒุณุช ู ุชฺฉูู ฺุดูโุงูุฏุงุฒ ฺฉุงูุจุฏ ุดูุฑฺฉ.</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-white text-center p-4 mt-8 border-t">
        <p class="text-slate-600">ุชูู ุดุฏู ุชูุณุท 
            <span class="tooltip font-bold text-slate-700">ูููุฏุณู ูุดุงูุฑ ุงุฏู ูพุฑุฏุงุฒ ูุญุท
                <span class="tooltiptext !w-48 !ml-[-96px] !bg-[#1e293b] !text-white">
                    ุชุญูู ู ุทุฑุงุญ: ุญูุฏุฑุถุง ุชุฑุงุจ
                </span>
            </span>
             - ุจุฑ ุงุณุงุณ ุชุญูู ุดูุฑูุฑ ฑดฐณ
        </p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Global Chart Font Settings ---
            Chart.defaults.font.family = "'Vazirmatn', sans-serif";

            // --- Updated Data Setup ---
            const decisionMatrix = [
                {id: 'P11', project: 'ุขุจุฑุณุงู', neighborhood: 1, c1: 0.14, c2: 175, c3: 1264.2, c4: 67634, c5: 6, c6: 4, c7: 4},
                {id: 'P12', project: 'ุจุฑูโุฑุณุงู', neighborhood: 1, c1: 0.08, c2: 175, c3: 1018.9, c4: 54534, c5: 5, c6: 3, c7: 4},
                {id: 'P13', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 1, c1: 0.17, c2: 175, c3: 2094.3, c4: 111433, c5: 4, c6: 3, c7: 3},
                {id: 'P14', project: 'ูุงุถูุงุจ', neighborhood: 1, c1: 1.00, c2: 175, c3: 18603.8, c4: 986000, c5: 3, c6: 5, c7: 5},
                {id: 'P15', project: 'ุฑุงูโุณุงุฒ', neighborhood: 1, c1: 0.20, c2: 175, c3: 10245.3, c4: 543000, c5: 1, c6: 2, c7: 2},
                {id: 'P21', project: 'ุขุจุฑุณุงู', neighborhood: 2, c1: 0.07, c2: 4679, c3: 925.4, c4: 1312000, c5: 6, c6: 3, c7: 4},
                {id: 'P22', project: 'ุจุฑูโุฑุณุงู', neighborhood: 2, c1: 0.02, c2: 4679, c3: 99.2, c4: 140000, c5: 5, c6: 3, c7: 4},
                {id: 'P23', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 2, c1: 0.10, c2: 4679, c3: 956.4, c4: 1356000, c5: 4, c6: 3, c7: 3},
                {id: 'P24', project: 'ูุงุถูุงุจ', neighborhood: 2, c1: 1.00, c2: 4679, c3: 810.3, c4: 1149000, c5: 3, c6: 5, c7: 5},
                {id: 'P25', project: 'ุฑุงูโุณุงุฒ', neighborhood: 2, c1: 0.10, c2: 4679, c3: 9226.4, c4: 13080000, c5: 1, c6: 2, c7: 2},
                {id: 'P31', project: 'ุขุจุฑุณุงู', neighborhood: 3, c1: 0.07, c2: 3231, c3: 124.5, c4: 121900, c5: 6, c6: 3, c7: 4},
                {id: 'P32', project: 'ุจุฑูโุฑุณุงู', neighborhood: 3, c1: 0.09, c2: 3231, c3: 143.9, c4: 140900, c5: 5, c6: 3, c7: 4},
                {id: 'P33', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 3, c1: 0.06, c2: 3231, c3: 129.6, c4: 126900, c5: 4, c6: 3, c7: 3},
                {id: 'P34', project: 'ูุงุถูุงุจ', neighborhood: 3, c1: 1.00, c2: 3231, c3: 715.0, c4: 700000, c5: 3, c6: 5, c7: 5},
                {id: 'P35', project: 'ุฑุงูโุณุงุฒ', neighborhood: 3, c1: 0.10, c2: 3231, c3: 1199.2, c4: 1174000, c5: 1, c6: 2, c7: 2},
                {id: 'P41', project: 'ุขุจุฑุณุงู', neighborhood: 4, c1: 0.28, c2: 350, c3: 1500.0, c4: 159000, c5: 6, c6: 3, c7: 4},
                {id: 'P42', project: 'ุจุฑูโุฑุณุงู', neighborhood: 4, c1: 0.27, c2: 350, c3: 1971.7, c4: 209000, c5: 5, c6: 3, c7: 4},
                {id: 'P43', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 4, c1: 0.17, c2: 350, c3: 1264.2, c4: 134000, c5: 4, c6: 3, c7: 3},
                {id: 'P44', project: 'ูุงุถูุงุจ', neighborhood: 4, c1: 1.00, c2: 350, c3: 11169.8, c4: 1184000, c5: 3, c6: 5, c7: 5},
                {id: 'P45', project: 'ุฑุงูโุณุงุฒ', neighborhood: 4, c1: 0.26, c2: 350, c3: 7717.0, c4: 818000, c5: 1, c6: 2, c7: 2},
                {id: 'P51', project: 'ุขุจุฑุณุงู', neighborhood: 5, c1: 0.01, c2: 2798, c3: 83.5, c4: 70800, c5: 6, c6: 3, c7: 4},
                {id: 'P52', project: 'ุจุฑูโุฑุณุงู', neighborhood: 5, c1: 0.01, c2: 2798, c3: 84.7, c4: 71900, c5: 5, c6: 3, c7: 4},
                {id: 'P53', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 5, c1: 0.01, c2: 2798, c3: 84.7, c4: 71900, c5: 4, c6: 3, c7: 3},
                {id: 'P54', project: 'ูุงุถูุงุจ', neighborhood: 5, c1: 1.00, c2: 2798, c3: 537.7, c4: 456000, c5: 3, c6: 5, c7: 5},
                {id: 'P55', project: 'ุฑุงูโุณุงุฒ', neighborhood: 5, c1: 0.03, c2: 2798, c3: 846.0, c4: 718000, c5: 1, c6: 2, c7: 2},
                {id: 'P61', project: 'ุขุจุฑุณุงู', neighborhood: 6, c1: 0.15, c2: 1086, c3: 610.3, c4: 200800, c5: 6, c6: 3, c7: 4},
                {id: 'P62', project: 'ุจุฑูโุฑุณุงู', neighborhood: 6, c1: 0.11, c2: 1086, c3: 610.9, c4: 201000, c5: 5, c6: 3, c7: 4},
                {id: 'P63', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 6, c1: 0.11, c2: 1086, c3: 611.5, c4: 201200, c5: 4, c6: 3, c7: 3},
                {id: 'P64', project: 'ูุงุถูุงุจ', neighborhood: 6, c1: 1.00, c2: 1086, c3: 1519.8, c4: 500000, c5: 3, c6: 5, c7: 5},
                {id: 'P65', project: 'ุฑุงูโุณุงุฒ', neighborhood: 6, c1: 0.22, c2: 1086, c3: 887.5, c4: 292000, c5: 1, c6: 2, c7: 2},
                {id: 'P71', project: 'ุขุจุฑุณุงู', neighborhood: 7, c1: 0.47, c2: 86, c3: 423.1, c4: 11000, c5: 6, c6: 3, c7: 4},
                {id: 'P72', project: 'ุจุฑูโุฑุณุงู', neighborhood: 7, c1: 0.51, c2: 86, c3: 9769.2, c4: 254000, c5: 5, c6: 3, c7: 4},
                {id: 'P73', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 7, c1: 0.57, c2: 86, c3: 10846.2, c4: 282000, c5: 4, c6: 3, c7: 3},
                {id: 'P74', project: 'ูุงุถูุงุจ', neighborhood: 7, c1: 1.00, c2: 86, c3: 28961.5, c4: 753000, c5: 3, c6: 5, c7: 5},
                {id: 'P75', project: 'ุฑุงูโุณุงุฒ', neighborhood: 7, c1: 0.43, c2: 86, c3: 33269.2, c4: 865000, c5: 1, c6: 2, c7: 2},
                {id: 'P81', project: 'ุขุจุฑุณุงู', neighborhood: 8, c1: 0.36, c2: 360, c3: 1743.1, c4: 190000, c5: 6, c6: 3, c7: 4},
                {id: 'P82', project: 'ุจุฑูโุฑุณุงู', neighborhood: 8, c1: 0.56, c2: 360, c3: 3834.9, c4: 418000, c5: 5, c6: 3, c7: 4},
                {id: 'P83', project: 'ฺฏุงุฒุฑุณุงู', neighborhood: 8, c1: 0.56, c2: 360, c3: 3834.9, c4: 418000, c5: 4, c6: 3, c7: 3},
                {id: 'P84', project: 'ูุงุถูุงุจ', neighborhood: 8, c1: 1.00, c2: 360, c3: 10385.3, c4: 1132000, c5: 3, c6: 5, c7: 5},
                {id: 'P85', project: 'ุฑุงูโุณุงุฒ', neighborhood: 8, c1: 0.54, c2: 360, c3: 14972.5, c4: 1632000, c5: 1, c6: 2, c7: 2},
            ];
            
            // ุดฑ: ุฑูุน ฺฉูุจูุฏ, ุดฒ: ุฌูุนุช, ุดณ: ูุฒูู/ุฎุงููุงุฑ, ุดด: ูุฒูู ฺฉู, ุดต: ุชูุงู ูู, ุดถ: ูุญุท ุฒุณุช, ุดท: ุจูุฏุงุดุช/ุงูู
            const criteriaInfo = {
                c1: { weight: 0.125, positive: true, name: 'ุฑูุน ฺฉูุจูุฏ' },
                c2: { weight: 0.094, positive: true, name: 'ุฌูุนุช' },
                c3: { weight: 0.175, positive: false, name: 'ูุฒูู/ุฎุงููุงุฑ' },
                c4: { weight: 0.125, positive: false, name: 'ูุฒูู ฺฉู' },
                c5: { weight: 0.350, positive: true, name: 'ุชูุงู ูู' },
                c6: { weight: 0.100, positive: true, name: 'ูุญุท ุฒุณุช' },
                c7: { weight: 0.031, positive: true, name: 'ุจูุฏุงุดุช/ุงูู' }
            };

            const initialWeights = { social: 25, economic: 30, technical: 35, environmental: 10 };
            let currentWeights = { ...initialWeights };
            let topProjectsChart, projectTypeChart;
            let finalRankings = [];
            let typeAveragesWithCost = [];

            const scenarios = {
                SMART_GROWTH: {
                    name: 'ุณูุงุฑู ยซุฑุดุฏ ููุดููุฏ ู ุฏุณุชุงูุฑุฏูุง ุณุฑุนยป',
                    icon: '๐ง',
                    color: '#475569', // Slate
                    content: `
                        <p class="text-slate-600 mb-4">ุจุง ุงู ุชุฑฺฉุจ ุงุฒ ูุฒูโูุงุ ุงูููุชโุจูุฏ ุจู ุณูุช ูพุฑูฺูโูุง ฺฏุฑุงุด ูพุฏุง ูโฺฉูุฏ ฺฉู ุชุฑฺฉุจ ุจููู ุงุฒ <strong>ุถุฑูุฑุช ูู ุจุงูุง</strong> ู <strong>ฺฉุงุฑุง ุงูุชุตุงุฏ ุนุงู</strong> ุฑุง ุงุฑุงุฆู ูโุฏููุฏ.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <h4 class="font-bold mb-2 text-green-600">ุฏุฑ ุงูููุช ุจุงูุง:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li><strong>ูพุฑูฺูโูุง ุขุจุฑุณุงู ู ุจุฑูโุฑุณุงู:</strong> ุจู ุฏูู ุงููุช ุญุงุช ุฏุฑ ุดุงุฎุต ยซุชูุงู ููยป.</li>
                                    <li><strong>ุฏุฑ ูุญููโูุง ตุ ณ ู ฒ:</strong> ุจู ุฏูู ุนููฺฉุฑุฏ ุนุงู ุฏุฑ ุดุงุฎุต ยซุชูุฌู ุงูุชุตุงุฏยป ู ูุฒูู ูพุงู ุจู ุงุฒุง ูุฑ ุฎุงููุงุฑ.</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2 text-red-600">ุฏุฑ ุงูููุช ูพุงู:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li><strong>ูพุฑูฺูโูุง ุฑุงูโุณุงุฒ ู ุขุณูุงูุช:</strong> ุจู ุฏูู ฺฉุณุจ ฺฉูุชุฑู ุงูุชุงุฒ ุฏุฑ ุดุงุฎุต ฺฉูุฏ ยซุชูุงู ููยป.</li>
                                    <li><strong>ูพุฑูฺูโูุง ูุงุถูุงุจ:</strong> ุจุง ูุฌูุฏ ุงููุช ุฒุณุชโูุญุทุ ูพุณ ุงุฒ ุขุจุ ุจุฑู ู ฺฏุงุฒ ูุฑุงุฑ ูโฺฏุฑูุฏ.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-4 pt-3 border-t border-slate-200 text-center font-bold text-slate-800">
                            <p>"ุงุจุชุฏุง ุฎุฏูุงุช ุญุงุช (ุขุจ ู ุจุฑู) ุฑุง ุจุง ฺฉูุชุฑู ูุฒูู ุจู ุจุดุชุฑู ุชุนุฏุงุฏ ุงูุฑุงุฏ ุจุฑุณุงูุ ุณูพุณ ุจู ุณุฑุงุบ ููุงุทู ูุญุฑููโุชุฑ ุจุฑู ู ุฏุฑ ููุงุช ุดุจฺฉูโูุง ุฑุง ุชฺฉูู ฺฉู."</p>
                        </div>
                    `
                },
                JUSTICE: {
                    name: 'ุณูุงุฑู ยซุนุฏุงูุชโูุญูุฑยป',
                    icon: 'โ๏ธ',
                    color: '#7a5195', // Social color
                    content: `
                        <p class="text-slate-600 mb-4">ุฏุฑ ุงู ุณูุงุฑูุ ูุฏู ุงุตู ุงุตูุงุญ ุณุฑุน ูุงุจุฑุงุจุฑโูุง ู ุฑุณุงูุฏู ุฎุฏูุงุช ุจู <strong>ูุญุฑููโุชุฑู ููุงุทู</strong> ุงุณุชุ ุญุช ุงฺฏุฑ ุงุฒ ูุธุฑ ุงูุชุตุงุฏ ฺฉุงููุงู ุจููู ูุจุงุดุฏ.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <h4 class="font-bold mb-2 text-green-600">ุฏุฑ ุงูููุช ุจุงูุง:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li>ูพุฑูฺูโูุง ุฏุฑ <strong>ูุญููโูุง ท ู ธ</strong> (ูุญุฑููโุชุฑู ููุงุทู) ุจู ุตุฏุฑ ูุณุช ุตุนูุฏ ูโฺฉููุฏ.</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2 text-red-600">ุฏุฑ ุงูููุช ูพุงู:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                     <li>ูพุฑูฺูโูุง ฺฉุงุฑุขูุฏ ุงูุชุตุงุฏ ุฏุฑ <strong>ูุญููโูุง ฒ ู ต</strong> ุจู ุฑุชุจูโูุง ูพุงูโุชุฑ ููุชูู ูโุดููุฏ.</li>
                                </ul>
                            </div>
                        </div>
                         <div class="mt-4 pt-3 border-t border-slate-200 text-center font-bold text-slate-800">
                            <p>ุงูููุชโุจูุฏ ููุง ุจุฑ ุงุณุงุณ <strong>ูููุนุช ุฌุบุฑุงูุง ู ูุฒุงู ูุญุฑููุช</strong> ูุฑุชุจ ูโุดูุฏ.</p>
                        </div>
                    `
                },
                EFFICIENCY: {
                    name: 'ุณูุงุฑู ยซฺฉุงุฑุงโูุญูุฑยป',
                    icon: '๐ฐ',
                    color: '#ef5675', // Economic color
                    content: `
                        <p class="text-slate-600 mb-4">ุฏุฑ ุงู ุณูุงุฑูุ ูุฏู ุงุตู ุงุณุชูุงุฏู ุจููู ุงุฒ ุจูุฏุฌู ูุญุฏูุฏ ู ฺฉุณุจ <strong>ุจุดุชุฑู ุจุงุฒุฏู ุงุฌุชูุงุน</strong> ุฏุฑ ฺฉูุชุงูโุชุฑู ุฒูุงู ููฺฉู ุงุณุช.</p>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <h4 class="font-bold mb-2 text-green-600">ุฏุฑ ุงูููุช ุจุงูุง:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                     <li>ูพุฑูฺูโูุง ุขุจุฑุณุงู ู ุจุฑูโุฑุณุงู ุฏุฑ <strong>ูุญููโูุง ฒุ ณ ู ต</strong> (ููุงุทู ูพุฑุฌูุนุช ู ฺฉุงุฑุขูุฏ) ุฏุฑ ุงูููุช ูุทูู ูุฑุงุฑ ูโฺฏุฑูุฏ.</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2 text-red-600">ุฏุฑ ุงูููุช ูพุงู:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                     <li>ูพุฑูฺูโูุง ุญุงุช ุฏุฑ <strong>ูุญููโูุง ท ู ธ</strong> ุจู ุฏูู ูุฒูู ุจุงูุงุชุฑ ุจู ุงุฒุง ูุฑ ุฎุงููุงุฑุ ุจู ุชุนูู ูโุงูุชูุฏ.</li>
                                </ul>
                            </div>
                        </div>
                         <div class="mt-4 pt-3 border-t border-slate-200 text-center font-bold text-slate-800">
                            <p>ุงู ูุฏู ฺฉ <strong>ุชุญูู ูุฒูู-ูุงุฏู ฺฉูุงุณฺฉ</strong> ุงุณุช ฺฉู ุณุฑูุงูโฺฏุฐุงุฑโูุง ุฒูุฏุจุงุฒุฏู ุฑุง ุฏุฑ ุงูููุช ูุฑุงุฑ ูโุฏูุฏ.</p>
                        </div>
                    `
                },
                TECHNICAL: {
                    name: 'ุณูุงุฑู ยซููโูุญูุฑยป',
                    icon: 'โ๏ธ',
                    color: '#bc5090', // Technical color
                    content: `
                        <p class="text-slate-600 mb-4">ุฏุฑ ุงู ุณูุงุฑูุ ูฺโฺุฒ ุจู ุฌุฒ <strong>ุชุฑุชุจ ุตุญุญ ุงุฌุฑุง ูพุฑูฺูโูุง</strong> ุจุฑ ุงุณุงุณ ุงุตูู ูููุฏุณ ุงููุช ูุฏุงุฑุฏ ู ุนูุงูู ุงุฌุชูุงุน ู ุงูุชุตุงุฏ ุฏุฑ ุฏุฑุฌู ุฏูู ุงููุช ูุฑุงุฑ ุฏุงุฑูุฏ.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <h4 class="font-bold mb-2 text-green-600">ุฏุฑ ุงูููุช ุจุงูุง:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                     <li>ุงุจุชุฏุง <strong>ุชูุงู ูพุฑูฺูโูุง ุขุจุฑุณุงู</strong> ุงุฒ ููู ูุญูุงุชุ ุณูพุณ ุชูุงู ูพุฑูฺูโูุง ุจุฑูโุฑุณุงู ู ุจู ููู ุชุฑุชุจ.</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2 text-red-600">ุฏุฑ ุงูููุช ูพุงู:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li>ููููู <strong>ุงูููุชโุจูุฏ ุจู ูุญูุงุช</strong> ุชูุฑุจุงู ุงุฒ ุจู ูโุฑูุฏ ู ููุท ููุน ูพุฑูฺู ุชุนูโฺฉููุฏู ุงุณุช.</li>
                                </ul>
                            </div>
                        </div>
                         <div class="mt-4 pt-3 border-t border-slate-200 text-center font-bold text-slate-800">
                            <p>ุฑุชุจูโุจูุฏ ููุง ฺฉ <strong>ููุดู ุฑุงู ูู ุฎุงูุต</strong> ุจุฑุง ุงุฌุฑุง ูุงูโูุง ุฒุฑุณุงุฎุช ุงุฒ ูพุงู ุจู ุจุงูุง ุฎูุงูุฏ ุจูุฏ.</p>
                        </div>
                    `
                },
                ENVIRONMENT: {
                    name: 'ุณูุงุฑู ยซูุญุทโุฒุณุชโูุญูุฑยป',
                    icon: '๐ฟ',
                    color: '#ffa600', // Environmental color
                    content: `
                        <p class="text-slate-600 mb-4">ุฏุฑ ุงู ุณูุงุฑูุ <strong>ุญูุงุธุช ุงุฒ ููุงุจุน ุทุจุน</strong> ููุญุตุฑุจูโูุฑุฏ ููุทูู ู ุฌููฺฏุฑ ุงุฒ ุขููุฏฺฏโูุง ุฒุณุชโูุญุท ุจู ุงูููุช ุงุตู ุชุจุฏู ูโุดูุฏ.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <h4 class="font-bold mb-2 text-green-600">ุฏุฑ ุงูููุช ุจุงูุง:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li>ูพุฑูฺูโูุง <strong>ุดุจฺฉู ุฌูุนโุขูุฑ ูุงุถูุงุจ</strong> ุฌูุด ูุงุจู ุชูุฌู ุฏุฑ ูุณุช ุฎูุงููุฏ ุฏุงุดุช ู ููฺฉู ุงุณุช ุจูุงูุงุตูู ูพุณ ุงุฒ ูพุฑูฺูโูุง ุญุงุช ุขุจ ู ุจุฑู ูุฑุงุฑ ฺฏุฑูุฏ.</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2 text-red-600">ุฏุฑ ุงูููุช ูพุงู:</h4>
                                <ul class="list-disc pr-4 space-y-1 text-slate-700">
                                    <li>ูพุฑูฺูโูุง ฺฉู ุชุฃุซุฑ ุฒุณุชโูุญุท ุฎุงุต ูุฏุงุฑูุฏ (ูุงููุฏ ฺฏุงุฒุฑุณุงู) ููฺฉู ุงุณุช ุฏุฑ ุฑุชุจูโุจูุฏ ุงูุช ฺฉููุฏ.</li>
                                </ul>
                            </div>
                        </div>
                         <div class="mt-4 pt-3 border-t border-slate-200 text-center font-bold text-slate-800">
                            <p>ูุณุช ุงูููุชโูุง ุจู ุณูุช ูพุฑูฺูโูุง ฺฉู ุจู <strong>ุณูุงูุช ุจููุฏูุฏุช ุงฺฉูุณุณุชู</strong> ููุทูู ฺฉูฺฉ ูโฺฉููุฏุ ูุชูุงู ูโุดูุฏ.</p>
                        </div>
                    `
                }
            };
            
            function normalizeMatrix(matrix, criteria) {
                let normalized = JSON.parse(JSON.stringify(matrix));
                for (const key in criteria) {
                    const values = matrix.map(p => p[key]);
                    const min = Math.min(...values);
                    const max = Math.max(...values);
                    const isPositive = criteria[key].positive;

                    normalized.forEach(p => {
                        if (max === min) {
                            p[key] = 1;
                        } else {
                            if (isPositive) {
                                p[key] = (p[key] - min) / (max - min);
                            } else {
                                p[key] = (max - p[key]) / (max - min);
                            }
                        }
                    });
                }
                return normalized;
            }

            function topsis(normalizedMatrix, weights) {
                const weightedMatrix = normalizedMatrix.map(p => {
                    let newP = { id: p.id };
                    for (const key in criteriaInfo) {
                        newP[key] = p[key] * weights[key];
                    }
                    return newP;
                });

                const idealBest = {};
                const idealWorst = {};
                for (const key in criteriaInfo) {
                    const values = weightedMatrix.map(p => p[key]);
                    idealBest[key] = Math.max(...values);
                    idealWorst[key] = Math.min(...values);
                }

                const distances = weightedMatrix.map(p => {
                    let distBest = 0;
                    let distWorst = 0;
                    for (const key in criteriaInfo) {
                        distBest += Math.pow(p[key] - idealBest[key], 2);
                        distWorst += Math.pow(p[key] - idealWorst[key], 2);
                    }
                    return {
                        id: p.id,
                        distBest: Math.sqrt(distBest),
                        distWorst: Math.sqrt(distWorst)
                    };
                });
                
                return distances.map(d => {
                    const closeness = d.distWorst / (d.distBest + d.distWorst);
                    const originalData = decisionMatrix.find(p => p.id === d.id);
                    return {
                        id: d.id,
                        name: originalData.project,
                        neighborhood: originalData.neighborhood,
                        finalScore: isNaN(closeness) ? 0 : closeness
                    };
                }).sort((a, b) => b.finalScore - a.finalScore);
            }

            function calculateFinalScores(weights) {
                 const subIndicatorWeights = {
                    c1: (weights.social / 100) * 0.125, c2: (weights.social / 100) * 0.094, c7: (weights.social / 100) * 0.031,
                    c3: (weights.economic / 100) * 0.175, c4: (weights.economic / 100) * 0.125,
                    c5: (weights.technical / 100) * 0.350,
                    c6: (weights.environmental / 100) * 0.100,
                };

                const totalWeight = Object.values(subIndicatorWeights).reduce((a,b)=>a+b,0);
                for (const key in subIndicatorWeights) {
                    subIndicatorWeights[key] = subIndicatorWeights[key] / totalWeight;
                }
                
                const normalizedData = normalizeMatrix(decisionMatrix, criteriaInfo);
                finalRankings = topsis(normalizedData, subIndicatorWeights);
                return finalRankings;
            }
           
            function getGradientColor(rank, total) {
                const p = (rank - 1) / (total - 1); // p goes from 0 for rank 1 to 1 for rank 40
                // HSL color wheel: 240 is blue, 120 is green, 60 is yellow, 0 is red.
                // This creates a gradient from Blue (high rank) to Red (low rank).
                const hue = 240 - (p * 240); 
                return `hsl(${hue}, 85%, 55%)`; 
            }

             function getTypeChartColor(score, minScore, maxScore) {
                if (maxScore === minScore) return `hsl(210, 85%, 55%)`; 
                const p = (score - minScore) / (maxScore - minScore);
                const hue = 30 + p * (210); 
                return `hsl(${hue}, 85%, 55%)`; 
            }

            function getRankJustification(rank, project) {
                const { neighborhood, name, id } = project;
                const originalData = decisionMatrix.find(p => p.id === id);

                if (rank <= 3 && name === 'ุขุจุฑุณุงู') return `<strong>ุชูุฌู:</strong> ุงู ูพุฑูฺู ุชุฑฺฉุจ ุงุฒ <strong>ุญุงุชโุชุฑู ููุน ุฒุฑุณุงุฎุช (ุขุจุฑุณุงู)</strong> ุจุง ฺฉ ุงุฒ <strong>ฺฉุงุฑุขูุฏุชุฑู ูุญูุงุช (${neighborhood})</strong> ุงุณุช. ุจุง ูุฒูู ุจูููุ ูุงุฒ ุงุณุงุณ ุชุนุฏุงุฏ ุฒุงุฏ ุฎุงููุงุฑ ุฑุง ุจุฑุทุฑู ูโฺฉูุฏ.`;
                if (rank >= 4 && rank <= 6 && name === 'ุจุฑูโุฑุณุงู') return `<strong>ุชูุฌู:</strong> ุงู ูพุฑูฺู <strong>ุฏููู ุฒุฑุณุงุฎุช ุญุงุช (ุจุฑู)</strong> ุฑุง ุฏุฑ ฺฉ ุงุฒ ูุญูุงุช ฺฉุงุฑุขูุฏ ู ูพุฑุฌูุนุช ุชฺฉูู ูโฺฉูุฏ ู ุจูุงูุงุตูู ูพุณ ุงุฒ ูพุฑูฺูโูุง ุขุจุฑุณุงู ูุฑุงุฑ ูโฺฏุฑุฏ.`;
                if (name === 'ุฑุงูโุณุงุฒ') return `<strong>ุชูุฌู:</strong> ุฑุชุจู ูพุงู ุจู ุฏูู ูุฑุงุฑฺฏุฑ ุฏุฑ <strong>ุงูุชูุง ุชูุงู ูู</strong> ุงุณุช. ุงู ูพุฑูฺู ุจุงุฏ ูพุณ ุงุฒ ุงุชูุงู ุชูุงู ุฒุฑุณุงุฎุชโูุง ุฒุฑุฒูู ุงุฌุฑุง ุดูุฏ ุชุง ุงุฒ ุชุฎุฑุจ ู ุฏูุจุงุฑูโฺฉุงุฑ ุฌููฺฏุฑ ุดูุฏ.`;
                if (name === 'ูุงุถูุงุจ') return `<strong>ุชูุฌู:</strong> ุฑุชุจู ูุชูุณุท ุจู ุฏูู <strong>ุงููุช ุจุงูุง ุฒุณุชโูุญุท</strong> ุงุณุชุ ูุฑฺูุฏ ุฏุฑ ุชูุงู ูู ูพุณ ุงุฒ ุขุจ ู ุจุฑู ูุฑุงุฑ ูโฺฏุฑุฏ.`;
                 if ((name === 'ุขุจุฑุณุงู' || name === 'ุจุฑูโุฑุณุงู') && (neighborhood === 7 || neighborhood === 8)) return `<strong>ุชูุฌู:</strong> ุงูููุช ุจุงูุง ุจู ุฏูู <strong>ุงููุช ูู ุญุงุช</strong> ู ุฑุงูุจุฑุฏ <strong>ุฑูุน ูุญุฑููุช</strong> ุฏุฑ ูุญูู ฺฉูุชุฑ ุชูุณุนูโุงูุชู ${neighborhood} ุงุณุช.`;

                return "<strong>ุชูุฌู:</strong> ุฑุชุจู ุงู ูพุฑูฺู ุญุงุตู ุชูุงุฒู ุจู ุงููุช ููุ ฺฉุงุฑุง ุงูุชุตุงุฏ ู ุชุฃุซุฑ ุงุฌุชูุงุน ุขู ุงุณุช.";
            }

            function updateUI() {
                const rankedProjects = calculateFinalScores(currentWeights);
                updateScenarioCard();
                updateTopProjectsChart(rankedProjects);
                updateTypeChart(rankedProjects);
                updatePriorityMatrix(rankedProjects);
            }
            function updateTopProjectsChart(rankedProjects) {
                const top10 = rankedProjects.slice(0, 10);
                topProjectsChart.data.labels = top10.map(p => `${p.name} - ูุญูู ${p.neighborhood}`);
                topProjectsChart.data.datasets[0].data = top10.map(p => p.finalScore);
                topProjectsChart.data.datasets[0].backgroundColor = top10.map((p, i) => getGradientColor(i + 1, 40));
                topProjectsChart.update();
            }
            function updateTypeChart(rankedProjects) {
                const projectTypeTotalCosts = { // in Billion Rials
                    'ุขุจุฑุณุงู': 680,
                    'ุจุฑูโุฑุณุงู': 1031,
                    'ฺฏุงุฒุฑุณุงู': 1096,
                    'ูุงุถูุงุจ': 6860,
                    'ุฑุงูโุณุงุฒ': 4704,
                    'ุฒูฺฉุด': 1473,
                    'ุฎุฏูุงุช ุฑูุจูุง': 149.2,
                    'ูพุฑูฺูโูุง ฺฏุฑุฏุดฺฏุฑ': 50000 
                };

                const types = ['ุขุจุฑุณุงู', 'ุจุฑูโุฑุณุงู', 'ฺฏุงุฒุฑุณุงู', 'ูุงุถูุงุจ', 'ุฑุงูโุณุงุฒ'];
                typeAveragesWithCost = types.map(type => {
                    const rankedProjectsOfType = rankedProjects.filter(p => p.name === type);
                    const avgScore = rankedProjectsOfType.length ? rankedProjectsOfType.reduce((acc, p) => acc + p.finalScore, 0) / rankedProjectsOfType.length : 0;
                    const totalCost = projectTypeTotalCosts[type] || 0;
                    return { type, avgScore, totalCost };
                });

                const interDistrictProjects = [
                    { type: 'ุฎุฏูุงุช ุฑูุจูุง', avgScore: 0.20, totalCost: projectTypeTotalCosts['ุฎุฏูุงุช ุฑูุจูุง'] },
                    { type: 'ุฒูฺฉุด', avgScore: 0.15, totalCost: projectTypeTotalCosts['ุฒูฺฉุด'] },
                    { type: 'ูพุฑูฺูโูุง ฺฏุฑุฏุดฺฏุฑ', avgScore: 0.13, totalCost: projectTypeTotalCosts['ูพุฑูฺูโูุง ฺฏุฑุฏุดฺฏุฑ'] }
                ];

                typeAveragesWithCost.push(...interDistrictProjects);
                
                typeAveragesWithCost.sort((a,b) => b.avgScore - a.avgScore);

                const scores = typeAveragesWithCost.map(t => t.avgScore);
                const minScore = Math.min(...scores);
                const maxScore = Math.max(...scores);

                projectTypeChart.data.labels = typeAveragesWithCost.map(t => t.type);
                projectTypeChart.data.datasets[0].data = scores;
                projectTypeChart.data.datasets[0].backgroundColor = scores.map(s => getTypeChartColor(s, minScore, maxScore));
                projectTypeChart.update();
            }
            function updatePriorityMatrix(rankedProjects) {
                const matrix = document.getElementById('priority-matrix');
                matrix.innerHTML = '';
                const headers = ['', 'ุขุจุฑุณุงู', 'ุจุฑูโ', 'ฺฏุงุฒ', 'ูุงุถูุงุจ', 'ุฑุงูโุณุงุฒ'];
                headers.forEach(h => {
                    const headerCell = document.createElement('div');
                    headerCell.className = 'font-bold text-slate-500 flex items-end justify-center pb-1';
                    headerCell.textContent = h;
                    matrix.appendChild(headerCell);
                });
                
                const projectRanks = {};
                rankedProjects.forEach((p, i) => { projectRanks[p.id] = i + 1; });
                const projectTypes = ['ุขุจุฑุณุงู', 'ุจุฑูโุฑุณุงู', 'ฺฏุงุฒุฑุณุงู', 'ูุงุถูุงุจ', 'ุฑุงูโุณุงุฒ'];
                for (let i = 1; i <= 8; i++) {
                    const rowHeader = document.createElement('div');
                    rowHeader.className = 'font-bold text-slate-500 flex items-center justify-center';
                    rowHeader.textContent = `ูุญูู ${i}`;
                    matrix.appendChild(rowHeader);
                    projectTypes.forEach(type => {
                        const project = decisionMatrix.find(p => p.neighborhood === i && p.project === type);
                        if (!project) return;

                        const rank = projectRanks[project.id];
                        const cell = document.createElement('div');
                        cell.className = 'tooltip matrix-tooltip';
                        const cellContent = document.createElement('div');
                        cellContent.className = 'priority-matrix-cell';
                        cellContent.style.backgroundColor = getGradientColor(rank, 40);
                        cellContent.textContent = rank;
                        
                        const tooltipText = document.createElement('span');
                        tooltipText.className = 'tooltiptext';
                        const justification = getRankJustification(rank, project);
                        const costInBillionToman = (project.c4 / 10000).toLocaleString('fa-IR', { maximumFractionDigits: 1 });
                        tooltipText.innerHTML = `
                            <strong class="block">${project.project} - ูุญูู ${project.neighborhood}</strong>
                            <hr class="my-1 border-slate-600">
                            <p class="text-xs text-right leading-relaxed px-1 py-1">${justification}</p>
                            <hr class="my-1 border-slate-600">
                             ุฑุชุจู: <span class="font-bold">${rank}</span> | ูุฒูู: <span class="font-bold">${costInBillionToman}</span> ููุงุฑุฏ ุชููุงู`;
                        cell.appendChild(cellContent);
                        cell.appendChild(tooltipText);
                        matrix.appendChild(cell);
                    });
                }
            }

            function updateScenarioCard() {
                const weights = currentWeights;
                let activeScenario = scenarios.SMART_GROWTH; // Default

                const maxWeight = Math.max(weights.social, weights.economic, weights.technical, weights.environmental);

                if (maxWeight > 45) { // A dimension is dominant
                    if (maxWeight === weights.social) activeScenario = scenarios.JUSTICE;
                    else if (maxWeight === weights.economic) activeScenario = scenarios.EFFICIENCY;
                    else if (maxWeight === weights.technical) activeScenario = scenarios.TECHNICAL;
                    else if (maxWeight === weights.environmental) activeScenario = scenarios.ENVIRONMENT;
                }
                
                // Update the card
                const card = document.getElementById('scenario-card');
                const iconEl = document.getElementById('scenario-icon');
                const titleEl = document.getElementById('scenario-title');
                const contentEl = document.getElementById('scenario-content');

                card.style.borderColor = activeScenario.color;
                iconEl.textContent = activeScenario.icon;
                iconEl.style.color = activeScenario.color;
                titleEl.textContent = activeScenario.name;
                titleEl.style.color = activeScenario.color;
                contentEl.innerHTML = activeScenario.content;
            }

            function setupControls() {
                const sliders = { social: document.getElementById('social-weight'), economic: document.getElementById('economic-weight'), technical: document.getElementById('technical-weight'), environmental: document.getElementById('environmental-weight') };
                const valueDisplays = { social: document.getElementById('social-weight-value'), economic: document.getElementById('economic-weight-value'), technical: document.getElementById('technical-weight-value'), environmental: document.getElementById('environmental-weight-value') };
                const cardValueDisplays = { social: document.getElementById('social-card-value'), economic: document.getElementById('economic-card-value'), technical: document.getElementById('technical-card-value'), environmental: document.getElementById('environmental-card-value') };

                function updateAllSliderUI() {
                    Object.keys(currentWeights).forEach(key => {
                        const val = Math.round(currentWeights[key]);
                        sliders[key].value = val;
                        const displayVal = `${val}%`;
                        valueDisplays[key].textContent = displayVal;
                        cardValueDisplays[key].textContent = displayVal;
                        const thumbColor = sliders[key].style.getPropertyValue('--thumb-color');
                        sliders[key].style.background = `linear-gradient(to left, ${thumbColor} ${val}%, #e2e8f0 ${val}%)`;
                    });
                }
                
                function syncAndNormalize(changedKey, newValue) {
                    const oldValue = currentWeights[changedKey];
                    let otherKeys = Object.keys(currentWeights).filter(k => k !== changedKey);
                    let sumOfOthersBeforeChange = otherKeys.reduce((acc, key) => currentWeights[key] + acc, 0);
                    let tempWeights = JSON.parse(JSON.stringify(currentWeights));
                    if (sumOfOthersBeforeChange < 1) { 
                        const remainingValue = 100 - newValue;
                        const valuePerKey = remainingValue / otherKeys.length;
                        otherKeys.forEach(key => { tempWeights[key] = valuePerKey; });
                    } else {
                        const remainingPercentage = 100 - newValue;
                        otherKeys.forEach(key => {
                            const ratio = currentWeights[key] / sumOfOthersBeforeChange;
                            tempWeights[key] = remainingPercentage * ratio;
                        });
                    }
                    tempWeights[changedKey] = newValue;
                    let total = Object.values(tempWeights).reduce((a, b) => a + b, 0);
                    tempWeights[changedKey] += (100 - total); 
                    currentWeights = tempWeights;
                    updateAllSliderUI();
                    updateUI();
                }
                
                Object.keys(sliders).forEach(key => {
                    sliders[key].addEventListener('input', (e) => syncAndNormalize(key, parseInt(e.target.value, 10)) );
                });

                document.getElementById('reset-weights').addEventListener('click', () => {
                    currentWeights = { ...initialWeights };
                    updateAllSliderUI();
                    updateUI();
                });

                const ctxTop = document.getElementById('topProjectsChart').getContext('2d');
                topProjectsChart = new Chart(ctxTop, {
                    type: 'bar', data: { labels: [], datasets: [{ label: 'ุงูุชุงุฒ ููุง', data: [], borderRadius: 4 }] },
                    options: { 
                        indexAxis: 'y', responsive: true, maintainAspectRatio: false, 
                        scales: { x: { beginAtZero: true, grid: { color: '#e2e8f0' }, ticks: { color: '#475569', font: { weight: 'bold' } } }, y: { grid: { display: false }, ticks: { color: '#475569', font: { weight: 'bold', size: 11 } } } }, 
                        plugins: { 
                            legend: { display: false }, 
                            tooltip: { 
                                rtl: true, titleFont: { family: 'Vazirmatn' }, bodyFont: { family: 'Vazirmatn' },
                                callbacks: {
                                    afterLabel: function(context) {
                                        const project = finalRankings[context.dataIndex];
                                        if (project) {
                                            const originalData = decisionMatrix.find(p => p.id === project.id);
                                            if (originalData) {
                                                 const cost = (originalData.c4 / 10000).toLocaleString('fa-IR', { maximumFractionDigits: 1 });
                                                 return `ูุฒูู: ${cost} ููุงุฑุฏ ุชููุงู`;
                                            }
                                        }
                                        return '';
                                    }
                                }
                            } 
                        } 
                    }
                });

                const ctxType = document.getElementById('projectTypeChart').getContext('2d');
                projectTypeChart = new Chart(ctxType, {
                    type: 'bar', data: { labels: [], datasets: [{ label: 'ูุงูฺฏู ุงูุชุงุฒ', data: [], borderRadius: 4 }] },
                     options: { 
                        responsive: true, maintainAspectRatio: false, 
                        scales: { 
                            y: { beginAtZero: true, grid: { color: '#e2e8f0' }, ticks: { color: '#475569', font: { weight: 'bold' } } }, 
                            x: { grid: { color: '#e2e8f0' }, ticks: { color: '#334155', font: { weight: 'bold', size: 12 } } } 
                        }, 
                        plugins: { 
                            legend: { display: false }, 
                            tooltip: { 
                                rtl: true, titleFont: { family: 'Vazirmatn' }, bodyFont: { family: 'Vazirmatn' },
                                callbacks: {
                                    afterLabel: function(context) {
                                        const typeInfo = typeAveragesWithCost[context.dataIndex];
                                        if (typeInfo) {
                                            const cost = (typeInfo.totalCost / 10).toLocaleString('fa-IR', { maximumFractionDigits: 1 });
                                            let tooltipString = `ูุฒูู ฺฉู: ${cost} ููุงุฑุฏ ุชููุงู`;
                                            if (typeInfo.type === 'ุจุฑูโุฑุณุงู') {
                                                tooltipString += '\n(ุจุฏูู ูุฒูู ุชุฌูุฒุงุช ูพุณุช)';
                                            }
                                            return tooltipString;
                                        }
                                        return '';
                                    }
                                }
                            } 
                        } 
                    }
                });
                updateAllSliderUI();
                updateUI();
            }

            setupControls();
        });
    </script>
</body>
</html>

